{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";function e(e,t,n,r,i,a,s){try{var o=e[a](s),c=o.value;}catch(e){return void n(e);}o.done?t(c):Promise.resolve(c).then(r,i);}function t(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\");}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable;}))),i.forEach(function(t){r(e,t,n[t]);});}return e;}function a(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t);}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function c(e,t,n){return(c=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0;}catch(e){return!1;}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r))();return n&&o(i,n.prototype),i;}).apply(null,arguments);}function u(e){var t=\"function\"==typeof Map?new Map():void 0;return(u=function u(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf(\"[native code]\")))return e;var n;if(\"function\"!=typeof e)throw new TypeError(\"Super expression must either be null or a function\");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r);}function r(){return c(e,arguments,s(this).constructor);}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,e);})(e);}function h(e,t){return!t||\"object\"!=typeof t&&\"function\"!=typeof t?function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e;}(e):t;}var l=function(e){function n(e){var r;return t(this,n),(r=h(this,s(n).call(this,\"Not Found! Params: \".concat(e)))).name=\"NotFoundError\",r.stack=new Error().stack,r;}return a(n,u(Error)),n;}(),f=function(e){function n(e){var r;return t(this,n),(r=h(this,s(n).call(this,\"Expired! Params: \".concat(e)))).name=\"ExpiredError\",r.stack=new Error().stack,r;}return a(n,u(Error)),n;}();export default(function(){function r(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t(this,r),this._SIZE=n.size||1e3,this.sync=n.sync||{},this.defaultExpires=void 0!==n.defaultExpires?n.defaultExpires:864e5,this.enableCache=!1!==n.enableCache,this._s=n.storageBackend||null,this._innerVersion=11,this.cache={},this._s&&this._s.setItem)try{var i=this._s.setItem(\"__react_native_storage_test\",\"test\");this.isPromise=!(!i||!i.then);}catch(e){throw console.warn(e),delete this._s,e;}else console.warn(\"Data would be lost after reload cause there is no storageBackend specified!\\n      \\nEither use localStorage(for web) or AsyncStorage(for React Native) as a storageBackend.\");this._mapPromise=this.getItem(\"map\").then(function(t){e._m=e._checkMap(t&&JSON.parse(t)||{});});}var a,s,o,c,u;return a=r,(s=[{key:\"getItem\",value:function value(e){return this._s?this.isPromise?this._s.getItem(e):Promise.resolve(this._s.getItem(e)):Promise.resolve();}},{key:\"setItem\",value:function value(e,t){return this._s?this.isPromise?this._s.setItem(e,t):Promise.resolve(this._s.setItem(e,t)):Promise.resolve();}},{key:\"removeItem\",value:function value(e){return this._s?this.isPromise?this._s.removeItem(e):Promise.resolve(this._s.removeItem(e)):Promise.resolve();}},{key:\"_initMap\",value:function value(){return{innerVersion:this._innerVersion,index:0,__keys__:{}};}},{key:\"_checkMap\",value:function value(e){return e&&e.innerVersion&&e.innerVersion===this._innerVersion?e:this._initMap();}},{key:\"_getId\",value:function value(e,t){return e+\"_\"+t;}},{key:\"_saveToMap\",value:function value(e){var t=e.key,n=e.id,r=e.data,i=this._getId(t,n),a=this._m;if(void 0!==a[i])return this.enableCache&&(this.cache[i]=JSON.parse(r)),this.setItem(\"map_\"+a[i],r);if(void 0!==a[a.index]){var s=a[a.index],o=s.split(\"_\");delete a[s],this._removeIdInKey(o[0],o[1]),this.enableCache&&delete this.cache[s];}if(a[i]=a.index,a[a.index]=i,a.__keys__[t]=a.__keys__[t]||[],a.__keys__[t].push(n),this.enableCache){var c=JSON.parse(r);this.cache[i]=c;}var u=a.index;++a.index===this._SIZE&&(a.index=0),this.setItem(\"map_\"+u,r),this.setItem(\"map\",JSON.stringify(a));}},{key:\"save\",value:function value(e){var t=this,n=e.key,r=e.id,i=e.data,a=e.rawData,s=e.expires,o=void 0===s?this.defaultExpires:s;-1!==n.toString().indexOf(\"_\")&&console.error('Please do not use \"_\" in key!');var c={rawData:i};if(void 0===i){if(void 0===a)return void console.error('\"data\" is required in save()!');console.warn('\"rawData\" is deprecated, please use \"data\" instead!'),c.rawData=a;}var u=Date.now();if(null!==o&&(c.expires=u+o),c=JSON.stringify(c),void 0===r){if(this.enableCache){var h=JSON.parse(c);this.cache[n]=h;}return this.setItem(n,c);}return-1!==r.toString().indexOf(\"_\")&&console.error('Please do not use \"_\" in id!'),this._mapPromise.then(function(){return t._saveToMap({key:n,id:r,data:c});});}},{key:\"getBatchData\",value:function value(e){var t=this;return Promise.all(e.map(function(e){return t.load(e);}));}},{key:\"getBatchDataWithIds\",value:(c=_regeneratorRuntime.mark(function e(t){var n,r,i,a,s,o,c,u,h=this;return _regeneratorRuntime.wrap(function(e){for(;;){switch(e.prev=e.next){case 0:return n=t.key,r=t.ids,i=t.syncInBackground,a=t.syncParams,s=r.map(function(e){return h.load({key:n,id:e,syncInBackground:i,autoSync:!1,batched:!0});}),e.next=4,Promise.all(s);case 4:if(o=e.sent,c=[],o.forEach(function(e){void 0!==e.syncId&&c.push(e.syncId);}),!c.length){e.next=14;break;}return e.next=10,this.sync[n]({id:c,syncParams:a});case 10:return u=e.sent,e.abrupt(\"return\",o.map(function(e){return e.syncId?u.shift():e;}));case 14:return e.abrupt(\"return\",o);case 15:case\"end\":return e.stop();}}},e,this);}),u=function u(){var t=this,n=arguments;return new Promise(function(r,i){var a=c.apply(t,n);function s(t){e(a,r,i,s,o,\"next\",t);}function o(t){e(a,r,i,s,o,\"throw\",t);}s(void 0);});},function(e){return u.apply(this,arguments);})},{key:\"_lookupGlobalItem\",value:function value(e){var t=this,n=e.key;return this.enableCache&&void 0!==this.cache[n]?this._loadGlobalItem(i({ret:this.cache[n]},e)):this.getItem(n).then(function(n){return t._loadGlobalItem(i({ret:n},e));});}},{key:\"_loadGlobalItem\",value:function value(e){var t=e.key,n=e.ret,r=e.autoSync,i=e.syncInBackground,a=e.syncParams;if(null==n){if(r&&this.sync[t])return this.sync[t]({syncParams:a});throw new l(JSON.stringify(e));}\"string\"==typeof n&&(n=JSON.parse(n),this.enableCache&&(this.cache[t]=n));var s=Date.now();if(n.expires<s){if(r&&this.sync[t]){if(i){try{this.sync[t]({syncParams:a,syncInBackground:i});}catch(e){}return n.rawData;}return this.sync[t]({syncParams:a,syncInBackground:i});}throw new f(JSON.stringify(e));}return n.rawData;}},{key:\"_noItemFound\",value:function value(e){var t=e.key,n=e.id,r=e.autoSync,i=e.syncParams;if(this.sync[t])return r?this.sync[t]({id:n,syncParams:i}):{syncId:n};throw new l(JSON.stringify(e));}},{key:\"_loadMapItem\",value:function value(e){var t=e.ret,n=e.key,r=e.id,i=e.autoSync,a=e.batched,s=e.syncInBackground,o=e.syncParams;if(null==t)return this._noItemFound(e);if(\"string\"==typeof t){t=JSON.parse(t);var c=e.key,u=e.id,h=this._getId(c,u);this.enableCache&&(this.cache[h]=t);}var l=Date.now();if(t.expires<l){if(i&&this.sync[n]){if(s){try{this.sync[n]({id:r,syncParams:o,syncInBackground:s});}catch(e){}return t.rawData;}return this.sync[n]({id:r,syncParams:o,syncInBackground:s});}if(a)return{syncId:r};throw new f(JSON.stringify(e));}return t.rawData;}},{key:\"_lookUpInMap\",value:function value(e){var t,n=this,r=this._m,a=e.key,s=e.id,o=this._getId(a,s);return this.enableCache&&this.cache[o]?(t=this.cache[o],this._loadMapItem(i({ret:t},e))):void 0!==r[o]?this.getItem(\"map_\"+r[o]).then(function(t){return n._loadMapItem(i({ret:t},e));}):this._noItemFound(i({ret:t},e));}},{key:\"remove\",value:function value(e){var t=this;return this._mapPromise.then(function(){var n=t._m,r=e.key,i=e.id;if(void 0===i)return t.enableCache&&t.cache[r]&&delete t.cache[r],t.removeItem(r);var a=t._getId(r,i);if(void 0!==n[a]){t.enableCache&&t.cache[a]&&delete t.cache[a],t._removeIdInKey(r,i);var s=n[a];return delete n[a],t.setItem(\"map\",JSON.stringify(n)),t.removeItem(\"map_\"+s);}});}},{key:\"_removeIdInKey\",value:function value(e,t){var n=(this._m.__keys__[e]||[]).indexOf(t);-1!==n&&this._m.__keys__[e].splice(n,1);}},{key:\"load\",value:function value(e){var t=this,n=e.key,r=e.id,i=e.autoSync,a=void 0===i||i,s=e.syncInBackground,o=void 0===s||s,c=e.syncParams,u=e.batched;return this._mapPromise.then(function(){return void 0===r?t._lookupGlobalItem({key:n,autoSync:a,syncInBackground:o,syncParams:c}):t._lookUpInMap({key:n,id:r,autoSync:a,syncInBackground:o,batched:u,syncParams:c});});}},{key:\"clearAll\",value:function value(){this._s.clear&&this._s.clear(),this._m=this._initMap();}},{key:\"clearMap\",value:function value(){var e=this;return this.removeItem(\"map\").then(function(){e.cache={},e._m=e._initMap();});}},{key:\"clearMapForKey\",value:function value(e){var t=this;return this._mapPromise.then(function(){var n=(t._m.__keys__[e]||[]).map(function(n){return t.remove({key:e,id:n});});return Promise.all(n);});}},{key:\"getIdsForKey\",value:function value(e){var t=this;return this._mapPromise.then(function(){return t._m.__keys__[e]||[];});}},{key:\"getAllDataForKey\",value:function value(e,t){var n=this;return t=_extends({syncInBackground:!0},t),this.getIdsForKey(e).then(function(r){var i=r.map(function(n){return{key:e,id:n,syncInBackground:t.syncInBackground};});return n.getBatchData(i);});}}])&&n(a.prototype,s),o&&n(a,o),r;})();","map":{"version":3,"sources":["../src/error.js","../src/storage.js"],"names":["NotFoundError","Error","message","name","stack","ExpiredError","options","_SIZE","size","sync","defaultExpires","undefined","enableCache","_s","storageBackend","_innerVersion","cache","this","setItem","promiseTest","isPromise","then","e","console","warn","_mapPromise","getItem","_this","_m","_checkMap","map","JSON","parse","key","Promise","resolve","value","removeItem","innerVersion","index","__keys__","_initMap","id","params","data","newId","_getId","m","oldId","splitOldId","split","_removeIdInKey","push","cacheData","currentIndex","stringify","rawData","expires","toString","indexOf","error","dataToSave","now","Date","_this2","_saveToMap","querys","all","_this3","load","query","ids","syncInBackground","syncParams","tasks","_this4","autoSync","batched","results","missingIds","forEach","syncId","length","syncData","shift","_loadGlobalItem","ret","_this5","_noItemFound","_loadMapItem","_this6","_this7","idTobeDeleted","indexTobeRemoved","splice","_this8","_lookupGlobalItem","_lookUpInMap","clear","_this9","_this10","remove","_this11","Object","getIdsForKey","_this12","getBatchData"],"mappings":"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","sourcesContent":["/**\n * Created by sunny on 9/1/16.\n */\n\nexport class NotFoundError extends Error {\n  constructor(message) {\n    super(`Not Found! Params: ${message}`);\n    this.name = 'NotFoundError';\n    this.stack = new Error().stack; // Optional\n  }\n}\n// NotFoundError.prototype = Object.create(Error.prototype);\n\nexport class ExpiredError extends Error {\n  constructor(message) {\n    super(`Expired! Params: ${message}`);\n    this.name = 'ExpiredError';\n    this.stack = new Error().stack; // Optional\n  }\n}\n// ExpiredError.prototype = Object.create(Error.prototype);\n","/*\n *  local storage(web/react native) wrapper\n *  sunnylqm\n */\nimport { NotFoundError, ExpiredError } from './error';\n\nexport default class Storage {\n  constructor(options = {}) {\n    this._SIZE = options.size || 1000; // maximum capacity\n    this.sync = options.sync || {}; // remote sync method\n    this.defaultExpires = options.defaultExpires !== undefined ? options.defaultExpires : 1000 * 3600 * 24;\n    this.enableCache = options.enableCache !== false;\n    this._s = options.storageBackend || null;\n    this._innerVersion = 11;\n    this.cache = {};\n\n    if (this._s && this._s.setItem) {\n      try {\n        var promiseTest = this._s.setItem('__react_native_storage_test', 'test');\n        this.isPromise = !!(promiseTest && promiseTest.then);\n      } catch (e) {\n        console.warn(e);\n        delete this._s;\n        throw e;\n      }\n    } else {\n      console.warn(`Data would be lost after reload cause there is no storageBackend specified!\n      \\nEither use localStorage(for web) or AsyncStorage(for React Native) as a storageBackend.`);\n    }\n\n    this._mapPromise = this.getItem('map').then(map => {\n      this._m = this._checkMap((map && JSON.parse(map)) || {});\n    });\n  }\n  getItem(key) {\n    return this._s\n      ? this.isPromise\n        ? this._s.getItem(key)\n        : Promise.resolve(this._s.getItem(key))\n      : Promise.resolve();\n  }\n  setItem(key, value) {\n    return this._s\n      ? this.isPromise\n        ? this._s.setItem(key, value)\n        : Promise.resolve(this._s.setItem(key, value))\n      : Promise.resolve();\n  }\n  removeItem(key) {\n    return this._s\n      ? this.isPromise\n        ? this._s.removeItem(key)\n        : Promise.resolve(this._s.removeItem(key))\n      : Promise.resolve();\n  }\n  _initMap() {\n    return {\n      innerVersion: this._innerVersion,\n      index: 0,\n      __keys__: {},\n    };\n  }\n  _checkMap(map) {\n    if (map && map.innerVersion && map.innerVersion === this._innerVersion) {\n      return map;\n    } else {\n      return this._initMap();\n    }\n  }\n  _getId(key, id) {\n    return key + '_' + id;\n  }\n  _saveToMap(params) {\n    let { key, id, data } = params,\n      newId = this._getId(key, id),\n      m = this._m;\n    if (m[newId] !== undefined) {\n      // update existing data\n      if (this.enableCache) this.cache[newId] = JSON.parse(data);\n      return this.setItem('map_' + m[newId], data);\n    }\n    if (m[m.index] !== undefined) {\n      // loop over, delete old data\n      let oldId = m[m.index];\n      let splitOldId = oldId.split('_');\n      delete m[oldId];\n      this._removeIdInKey(splitOldId[0], splitOldId[1]);\n      if (this.enableCache) {\n        delete this.cache[oldId];\n      }\n    }\n    m[newId] = m.index;\n    m[m.index] = newId;\n\n    m.__keys__[key] = m.__keys__[key] || [];\n    m.__keys__[key].push(id);\n\n    if (this.enableCache) {\n      const cacheData = JSON.parse(data);\n      this.cache[newId] = cacheData;\n    }\n    let currentIndex = m.index;\n    if (++m.index === this._SIZE) {\n      m.index = 0;\n    }\n    this.setItem('map_' + currentIndex, data);\n    this.setItem('map', JSON.stringify(m));\n  }\n  save(params) {\n    const { key, id, data, rawData, expires = this.defaultExpires } = params;\n    if (key.toString().indexOf('_') !== -1) {\n      console.error('Please do not use \"_\" in key!');\n    }\n    let dataToSave = { rawData: data };\n    if (data === undefined) {\n      if (rawData !== undefined) {\n        console.warn('\"rawData\" is deprecated, please use \"data\" instead!');\n        dataToSave.rawData = rawData;\n      } else {\n        console.error('\"data\" is required in save()!');\n        return;\n      }\n    }\n    let now = Date.now();\n    if (expires !== null) {\n      dataToSave.expires = now + expires;\n    }\n    dataToSave = JSON.stringify(dataToSave);\n    if (id === undefined) {\n      if (this.enableCache) {\n        const cacheData = JSON.parse(dataToSave);\n        this.cache[key] = cacheData;\n      }\n      return this.setItem(key, dataToSave);\n    } else {\n      if (id.toString().indexOf('_') !== -1) {\n        console.error('Please do not use \"_\" in id!');\n      }\n      return this._mapPromise.then(() =>\n        this._saveToMap({\n          key,\n          id,\n          data: dataToSave,\n        }),\n      );\n    }\n  }\n  getBatchData(querys) {\n    return Promise.all(querys.map(query => this.load(query)));\n  }\n  async getBatchDataWithIds(params) {\n    let { key, ids, syncInBackground, syncParams } = params;\n    const tasks = ids.map(id =>\n      this.load({\n        key,\n        id,\n        syncInBackground,\n        autoSync: false,\n        batched: true,\n      }),\n    );\n    const results = await Promise.all(tasks);\n    const missingIds = [];\n    results.forEach(value => {\n      if (value.syncId !== undefined) {\n        missingIds.push(value.syncId);\n      }\n    });\n    if (missingIds.length) {\n      const syncData = await this.sync[key]({\n        id: missingIds,\n        syncParams,\n      });\n      return results.map(value => {\n        return value.syncId ? syncData.shift() : value;\n      });\n    } else {\n      return results;\n    }\n  }\n  _lookupGlobalItem(params) {\n    const { key } = params;\n    if (this.enableCache && this.cache[key] !== undefined) {\n      return this._loadGlobalItem({ ret: this.cache[key], ...params });\n    }\n    return this.getItem(key).then(ret => this._loadGlobalItem({ ret, ...params }));\n  }\n  _loadGlobalItem(params) {\n    let { key, ret, autoSync, syncInBackground, syncParams } = params;\n    if (ret === null || ret === undefined) {\n      if (autoSync && this.sync[key]) {\n        return this.sync[key]({ syncParams });\n      }\n      throw new NotFoundError(JSON.stringify(params));\n    }\n    if (typeof ret === 'string') {\n      ret = JSON.parse(ret);\n      if (this.enableCache) {\n        this.cache[key] = ret;\n      }\n    }\n    let now = Date.now();\n    if (ret.expires < now) {\n      if (autoSync && this.sync[key]) {\n        if (syncInBackground) {\n          try {\n            this.sync[key]({ syncParams, syncInBackground });\n          } catch (e) {\n            // avoid uncaught exception\n          }\n          return ret.rawData;\n        }\n        return this.sync[key]({ syncParams, syncInBackground });\n      }\n      throw new ExpiredError(JSON.stringify(params));\n    }\n    return ret.rawData;\n  }\n  _noItemFound(params) {\n    let { key, id, autoSync, syncParams } = params;\n    if (this.sync[key]) {\n      if (autoSync) {\n        return this.sync[key]({ id, syncParams });\n      }\n      return { syncId: id };\n    }\n    throw new NotFoundError(JSON.stringify(params));\n  }\n  _loadMapItem(params) {\n    let { ret, key, id, autoSync, batched, syncInBackground, syncParams } = params;\n    if (ret === null || ret === undefined) {\n      return this._noItemFound(params);\n    }\n    if (typeof ret === 'string') {\n      ret = JSON.parse(ret);\n      const { key, id } = params;\n      const newId = this._getId(key, id);\n      if (this.enableCache) {\n        this.cache[newId] = ret;\n      }\n    }\n    let now = Date.now();\n    if (ret.expires < now) {\n      if (autoSync && this.sync[key]) {\n        if (syncInBackground) {\n          try {\n            this.sync[key]({ id, syncParams, syncInBackground });\n          } catch (e) {\n            // avoid uncaught exception\n          }\n          return ret.rawData;\n        }\n        return this.sync[key]({ id, syncParams, syncInBackground });\n      }\n      if (batched) {\n        return { syncId: id };\n      }\n      throw new ExpiredError(JSON.stringify(params));\n    }\n    return ret.rawData;\n  }\n  _lookUpInMap(params) {\n    let ret;\n    const m = this._m;\n    const { key, id } = params;\n    const newId = this._getId(key, id);\n    if (this.enableCache && this.cache[newId]) {\n      ret = this.cache[newId];\n      return this._loadMapItem({ ret, ...params });\n    }\n    if (m[newId] !== undefined) {\n      return this.getItem('map_' + m[newId]).then(ret => this._loadMapItem({ ret, ...params }));\n    }\n    return this._noItemFound({ ret, ...params });\n  }\n  remove(params) {\n    return this._mapPromise.then(() => {\n      let m = this._m;\n      let { key, id } = params;\n\n      if (id === undefined) {\n        if (this.enableCache && this.cache[key]) {\n          delete this.cache[key];\n        }\n        return this.removeItem(key);\n      }\n      let newId = this._getId(key, id);\n\n      // remove existing data\n      if (m[newId] !== undefined) {\n        if (this.enableCache && this.cache[newId]) {\n          delete this.cache[newId];\n        }\n        this._removeIdInKey(key, id);\n        let idTobeDeleted = m[newId];\n        delete m[newId];\n        this.setItem('map', JSON.stringify(m));\n        return this.removeItem('map_' + idTobeDeleted);\n      }\n    });\n  }\n  _removeIdInKey(key, id) {\n    const indexTobeRemoved = (this._m.__keys__[key] || []).indexOf(id);\n    if (indexTobeRemoved !== -1) {\n      this._m.__keys__[key].splice(indexTobeRemoved, 1);\n    }\n  }\n  load(params) {\n    const { key, id, autoSync = true, syncInBackground = true, syncParams, batched } = params;\n    return this._mapPromise.then(() => {\n      if (id === undefined) {\n        return this._lookupGlobalItem({\n          key,\n          autoSync,\n          syncInBackground,\n          syncParams,\n        });\n      } else {\n        return this._lookUpInMap({\n          key,\n          id,\n          autoSync,\n          syncInBackground,\n          batched,\n          syncParams,\n        });\n      }\n    });\n  }\n  clearAll() {\n    this._s.clear && this._s.clear();\n    this._m = this._initMap();\n  }\n  clearMap() {\n    return this.removeItem('map').then(() => {\n      this.cache = {};\n      this._m = this._initMap();\n    });\n  }\n  clearMapForKey(key) {\n    return this._mapPromise.then(() => {\n      let tasks = (this._m.__keys__[key] || []).map(id => this.remove({ key, id }));\n      return Promise.all(tasks);\n    });\n  }\n  getIdsForKey(key) {\n    return this._mapPromise.then(() => {\n      return this._m.__keys__[key] || [];\n    });\n  }\n  getAllDataForKey(key, options) {\n    options = Object.assign({ syncInBackground: true }, options);\n    return this.getIdsForKey(key).then(ids => {\n      const querys = ids.map(id => ({ key, id, syncInBackground: options.syncInBackground }));\n      return this.getBatchData(querys);\n    });\n  }\n}\n"]},"metadata":{},"sourceType":"module"}