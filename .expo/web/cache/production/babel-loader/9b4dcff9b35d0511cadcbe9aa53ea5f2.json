{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React,{Component}from'react';import View from\"react-native-web/dist/exports/View\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import Animated from\"react-native-web/dist/exports/Animated\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Image from\"react-native-web/dist/exports/Image\";import*as d3Shape from'd3-shape';import Svg,{G,Text,TSpan,Path,Pattern,Rect,Line}from'react-native-svg';var AnimatedSvg=Animated.createAnimatedComponent(Svg);var _Dimensions$get=Dimensions.get('screen'),width=_Dimensions$get.width,height=_Dimensions$get.height;var WheelOfFortune=function(_Component){_inherits(WheelOfFortune,_Component);var _super=_createSuper(WheelOfFortune);function WheelOfFortune(props){var _this;_classCallCheck(this,WheelOfFortune);_this=_super.call(this,props);_this.prepareWheel=function(){_this.Rewards=_this.props.options.rewards;_this.RewardCount=_this.Rewards.length;_this.numberOfSegments=_this.RewardCount;_this.fontSize=32;_this.onedeg=360;_this.angleBySegment=_this.onedeg/_this.numberOfSegments;_this.angleOffset=_this.angleBySegment/2;_this.winner=_this.props.options.winner?_this.props.options.winner:Math.floor(Math.random()*_this.numberOfSegments);_this._wheelPaths=_this.makeWheel();_this._angle=new Animated.Value(0);_this.props.options.onRef(_assertThisInitialized(_this));};_this.resetWheelState=function(){_this.setState({enabled:false,started:false,finished:false,winner:null,gameScreen:new Animated.Value(height/2),wheelOpacity:new Animated.Value(1),imageLeft:new Animated.Value(width/2-30),imageTop:new Animated.Value(height/2-70)});};_this._tryAgain=function(){_this.prepareWheel();_this.resetWheelState();_this.angleListener();_this._onPress();};_this.angleListener=function(){_this._angle.addListener(function(event){if(_this.state.enabled){_this.setState({enabled:false,finished:false});}_this.angle=event.value;});};_this.makeWheel=function(){var data=Array.from({length:_this.numberOfSegments}).fill(1);var arcs=d3Shape.pie()(data);var colors=_this.props.options.colors?_this.props.options.colors:['#E07026','#E8C22E','#ABC937','#4F991D','#22AFD3','#5858D0','#7B48C8','#D843B9','#E23B80','#D82B2B'];return arcs.map(function(arc,index){var instance=d3Shape.arc().padAngle(0.001).outerRadius(width/2).innerRadius(_this.props.options.innerRadius||100);return{path:instance(arc),color:colors[index%colors.length],value:_this.Rewards[index],centroid:instance.centroid(arc)};});};_this._getWinnerIndex=function(){var deg=Math.abs(Math.round(_this.angle%_this.onedeg));if(_this.angle<0){return Math.floor(deg/_this.angleBySegment);}return(_this.numberOfSegments-Math.floor(deg/_this.angleBySegment))%_this.numberOfSegments;};_this._onPress=function(){var duration=_this.props.options.duration||10000;_this.setState({started:true});Animated.timing(_this._angle,{toValue:365-_this.winner*(_this.onedeg/_this.numberOfSegments)+360*(duration/1000),duration:duration,useNativeDriver:true}).start(function(){var winnerIndex=_this._getWinnerIndex();_this.setState({finished:true,winner:_this._wheelPaths[winnerIndex].value});_this.props.getWinner(_this._wheelPaths[winnerIndex].value,winnerIndex);});};_this._textRender=function(x,y,number,i){return React.createElement(Text,{x:x-number.length*5,y:y-80,fill:_this.props.options.textColor?_this.props.options.textColor:'#fff',textAnchor:\"c\",fontSize:42,fontWeight:\"bold\"},Array.from({length:number.length}).map(function(_,j){if(_this.props.options.textAngle==='vertical'){return React.createElement(TSpan,{x:x,dy:_this.fontSize,key:\"arc-\"+i+\"-slice-\"+j},number.charAt(j));}else{return React.createElement(Svg,{height:\"100\",width:\"200\"},React.createElement(G,{rotation:\"50\",origin:\"100, 50\"},React.createElement(Line,{x1:\"60\",y1:\"10\",x2:\"140\",y2:\"10\",stroke:\"#060\"}),React.createElement(Rect,{x:\"60\",y:\"20\",height:\"50\",width:\"80\",stroke:\"#060\",fill:\"#060\"}),React.createElement(Text,{x:\"100\",y:\"75\",stroke:\"#600\",fill:\"#600\",textAnchor:\"middle\"},\"Text grouped with shapes\")));}}));};_this._renderSvgWheel=function(){return React.createElement(View,{style:styles.container},_this._renderKnob(),React.createElement(Animated.View,{style:{alignItems:'center',justifyContent:'center',transform:[{rotate:_this._angle.interpolate({inputRange:[-_this.onedeg,0,_this.onedeg],outputRange:[\"-\"+_this.onedeg+\"deg\",\"0deg\",_this.onedeg+\"deg\"]})}],backgroundColor:_this.props.options.backgroundColor?_this.props.options.backgroundColor:'#fff',width:height/2,height:height/2,borderRadius:(width-20)/2,borderWidth:_this.props.options.borderWidth?_this.props.options.borderWidth:2,borderColor:_this.props.options.borderColor?_this.props.options.borderColor:'#fff',opacity:_this.state.wheelOpacity}},React.createElement(AnimatedSvg,{width:_this.state.gameScreen,height:_this.state.gameScreen,viewBox:\"0 0 \"+width+\" \"+width,style:{transform:[{rotate:\"-\"+_this.angleOffset+\"deg\"}],margin:10}},React.createElement(G,{y:width/2,x:width/2},_this._wheelPaths.map(function(arc,i){var _arc$centroid=_slicedToArray(arc.centroid,2),x=_arc$centroid[0],y=_arc$centroid[1];var number=arc.value.toString();return React.createElement(G,{key:\"arc-\"+i},React.createElement(Path,{d:arc.path,strokeWidth:2,fill:arc.color}),React.createElement(G,{rotation:i*_this.onedeg/_this.numberOfSegments+_this.angleOffset,origin:x+\", \"+y},_this._textRender(x,y,number,i)));})))));};_this._renderKnob=function(){var knobSize=_this.props.options.knobSize?_this.props.options.knobSize:20;var YOLO=Animated.modulo(Animated.divide(Animated.modulo(Animated.subtract(_this._angle,_this.angleOffset),_this.onedeg),new Animated.Value(_this.angleBySegment)),1);return React.createElement(Animated.View,{style:{width:knobSize,height:knobSize*2,justifyContent:'flex-end',zIndex:1,opacity:_this.state.wheelOpacity,transform:[{rotate:YOLO.interpolate({inputRange:[-1,-0.5,-0.0001,0.0001,0.5,1],outputRange:['0deg','0deg','35deg','-35deg','0deg','0deg']})}]}},React.createElement(Svg,{width:knobSize,height:knobSize*100/57,viewBox:\"0 0 57 100\",style:{transform:[{translateY:8}]}},React.createElement(Image,{source:_this.props.options.knobSource?_this.props.options.knobSource:require(\"./assets/images/knob.png\"),style:{width:knobSize,height:knobSize*100/57}})));};_this.state={enabled:false,started:false,finished:false,winner:null,gameScreen:new Animated.Value(height/2),wheelOpacity:new Animated.Value(1),imageLeft:new Animated.Value(width/2-30),imageTop:new Animated.Value(height/2-70)};_this.angle=0;_this.prepareWheel();return _this;}_createClass(WheelOfFortune,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.props.options.onRef(undefined);}},{key:\"componentDidMount\",value:function componentDidMount(){this.angleListener();}},{key:\"_renderTopToPlay\",value:function _renderTopToPlay(){var _this2=this;if(this.state.started==false){return React.createElement(TouchableOpacity,{onPress:function onPress(){return _this2._onPress();}},this.props.options.playButton());}}},{key:\"render\",value:function render(){return React.createElement(View,{style:styles.container},React.createElement(TouchableOpacity,{style:{position:'absolute',width:width,height:height/2,justifyContent:'center',alignItems:'center'}},React.createElement(Animated.View,{style:[styles.content,{padding:10}]},this._renderSvgWheel())),this.props.options.playButton?this._renderTopToPlay():null);}}]);return WheelOfFortune;}(Component);export default WheelOfFortune;var styles=StyleSheet.create({container:{},content:{},startText:{}});","map":{"version":3,"sources":["D:/Poorliya/Spin_To_Win_Contest/spin_to_win/src/WheelOfFortune.js"],"names":["React","Component","d3Shape","Svg","G","Text","TSpan","Path","Pattern","Rect","Line","AnimatedSvg","Animated","createAnimatedComponent","Dimensions","get","width","height","WheelOfFortune","props","prepareWheel","Rewards","options","rewards","RewardCount","length","numberOfSegments","fontSize","onedeg","angleBySegment","angleOffset","winner","Math","floor","random","_wheelPaths","makeWheel","_angle","Value","onRef","resetWheelState","setState","enabled","started","finished","gameScreen","wheelOpacity","imageLeft","imageTop","_tryAgain","angleListener","_onPress","addListener","event","state","angle","value","data","Array","from","fill","arcs","pie","colors","map","arc","index","instance","padAngle","outerRadius","innerRadius","path","color","centroid","_getWinnerIndex","deg","abs","round","duration","timing","toValue","useNativeDriver","start","winnerIndex","getWinner","_textRender","x","y","number","i","textColor","_","j","textAngle","charAt","_renderSvgWheel","styles","container","_renderKnob","alignItems","justifyContent","transform","rotate","interpolate","inputRange","outputRange","backgroundColor","borderRadius","borderWidth","borderColor","opacity","margin","toString","knobSize","YOLO","modulo","divide","subtract","zIndex","translateY","knobSource","require","undefined","playButton","position","content","padding","_renderTopToPlay","StyleSheet","create","startText"],"mappings":"upCAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,KAA+B,OAA/B,C,wXASA,MAAO,GAAKC,CAAAA,OAAZ,KAAyB,UAAzB,CAEA,MAAOC,CAAAA,GAAP,EAAaC,CAAb,CAAgBC,IAAhB,CAAsBC,KAAtB,CAA6BC,IAA7B,CAAmCC,OAAnC,CAA6CC,IAA7C,CAAkDC,IAAlD,KACO,kBADP,CAGA,GAAMC,CAAAA,WAAW,CAAGC,QAAQ,CAACC,uBAAT,CAAiCV,GAAjC,CAApB,CAEA,oBAAwBW,UAAU,CAACC,GAAX,CAAe,QAAf,CAAxB,CAAOC,KAAP,iBAAOA,KAAP,CAAcC,MAAd,iBAAcA,MAAd,C,GAEMC,CAAAA,c,mGACJ,wBAAYC,KAAZ,CAAmB,gDACjB,uBAAMA,KAAN,EADiB,MAiBnBC,YAjBmB,CAiBJ,UAAM,CACnB,MAAKC,OAAL,CAAe,MAAKF,KAAL,CAAWG,OAAX,CAAmBC,OAAlC,CACA,MAAKC,WAAL,CAAmB,MAAKH,OAAL,CAAaI,MAAhC,CAEA,MAAKC,gBAAL,CAAwB,MAAKF,WAA7B,CACA,MAAKG,QAAL,CAAgB,EAAhB,CACA,MAAKC,MAAL,CAAc,GAAd,CACA,MAAKC,cAAL,CAAsB,MAAKD,MAAL,CAAc,MAAKF,gBAAzC,CACA,MAAKI,WAAL,CAAmB,MAAKD,cAAL,CAAsB,CAAzC,CACA,MAAKE,MAAL,CAAc,MAAKZ,KAAL,CAAWG,OAAX,CAAmBS,MAAnB,CACV,MAAKZ,KAAL,CAAWG,OAAX,CAAmBS,MADT,CAEVC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,GAAgB,MAAKR,gBAAhC,CAFJ,CAIA,MAAKS,WAAL,CAAmB,MAAKC,SAAL,EAAnB,CACA,MAAKC,MAAL,CAAc,GAAIzB,CAAAA,QAAQ,CAAC0B,KAAb,CAAmB,CAAnB,CAAd,CAEA,MAAKnB,KAAL,CAAWG,OAAX,CAAmBiB,KAAnB,gCACD,CAlCkB,OAoCnBC,eApCmB,CAoCD,UAAM,CACtB,MAAKC,QAAL,CAAc,CACZC,OAAO,CAAE,KADG,CAEZC,OAAO,CAAE,KAFG,CAGZC,QAAQ,CAAE,KAHE,CAIZb,MAAM,CAAE,IAJI,CAKZc,UAAU,CAAC,GAAIjC,CAAAA,QAAQ,CAAC0B,KAAb,CAAmBrB,MAAM,CAAG,CAA5B,CALC,CAMZ6B,YAAY,CAAE,GAAIlC,CAAAA,QAAQ,CAAC0B,KAAb,CAAmB,CAAnB,CANF,CAOZS,SAAS,CAAE,GAAInC,CAAAA,QAAQ,CAAC0B,KAAb,CAAmBtB,KAAK,CAAG,CAAR,CAAY,EAA/B,CAPC,CAQZgC,QAAQ,CAAE,GAAIpC,CAAAA,QAAQ,CAAC0B,KAAb,CAAmBrB,MAAM,CAAG,CAAT,CAAa,EAAhC,CARE,CAAd,EAUD,CA/CkB,OAiDnBgC,SAjDmB,CAiDP,UAAM,CAChB,MAAK7B,YAAL,GACA,MAAKoB,eAAL,GACA,MAAKU,aAAL,GACA,MAAKC,QAAL,GACD,CAtDkB,OAwDnBD,aAxDmB,CAwDH,UAAM,CACpB,MAAKb,MAAL,CAAYe,WAAZ,CAAwB,SAAAC,KAAK,CAAI,CAC/B,GAAI,MAAKC,KAAL,CAAWZ,OAAf,CAAwB,CACtB,MAAKD,QAAL,CAAc,CACZC,OAAO,CAAE,KADG,CAEZE,QAAQ,CAAE,KAFE,CAAd,EAID,CAED,MAAKW,KAAL,CAAaF,KAAK,CAACG,KAAnB,CACD,CATD,EAUD,CAnEkB,OA6EnBpB,SA7EmB,CA6EP,UAAM,CAChB,GAAMqB,CAAAA,IAAI,CAAGC,KAAK,CAACC,IAAN,CAAW,CAAClC,MAAM,CAAE,MAAKC,gBAAd,CAAX,EAA4CkC,IAA5C,CAAiD,CAAjD,CAAb,CACA,GAAMC,CAAAA,IAAI,CAAG3D,OAAO,CAAC4D,GAAR,GAAcL,IAAd,CAAb,CACA,GAAIM,CAAAA,MAAM,CAAG,MAAK5C,KAAL,CAAWG,OAAX,CAAmByC,MAAnB,CACT,MAAK5C,KAAL,CAAWG,OAAX,CAAmByC,MADV,CAET,CACE,SADF,CAEE,SAFF,CAGE,SAHF,CAIE,SAJF,CAKE,SALF,CAME,SANF,CAOE,SAPF,CAQE,SARF,CASE,SATF,CAUE,SAVF,CAFJ,CAcA,MAAOF,CAAAA,IAAI,CAACG,GAAL,CAAS,SAACC,GAAD,CAAMC,KAAN,CAAgB,CAC9B,GAAMC,CAAAA,QAAQ,CAAGjE,OAAO,CACrB+D,GADc,GAEdG,QAFc,CAEL,KAFK,EAGdC,WAHc,CAGFrD,KAAK,CAAG,CAHN,EAIdsD,WAJc,CAIF,MAAKnD,KAAL,CAAWG,OAAX,CAAmBgD,WAAnB,EAAkC,GAJhC,CAAjB,CAKA,MAAO,CACLC,IAAI,CAAEJ,QAAQ,CAACF,GAAD,CADT,CAELO,KAAK,CAAET,MAAM,CAACG,KAAK,CAAGH,MAAM,CAACtC,MAAhB,CAFR,CAGL+B,KAAK,CAAE,MAAKnC,OAAL,CAAa6C,KAAb,CAHF,CAILO,QAAQ,CAAEN,QAAQ,CAACM,QAAT,CAAkBR,GAAlB,CAJL,CAAP,CAMD,CAZM,CAAP,CAaD,CA3GkB,OA6GnBS,eA7GmB,CA6GD,UAAM,CACtB,GAAMC,CAAAA,GAAG,CAAG3C,IAAI,CAAC4C,GAAL,CAAS5C,IAAI,CAAC6C,KAAL,CAAW,MAAKtB,KAAL,CAAa,MAAK3B,MAA7B,CAAT,CAAZ,CAEA,GAAI,MAAK2B,KAAL,CAAa,CAAjB,CAAoB,CAClB,MAAOvB,CAAAA,IAAI,CAACC,KAAL,CAAW0C,GAAG,CAAG,MAAK9C,cAAtB,CAAP,CACD,CAED,MACE,CAAC,MAAKH,gBAAL,CAAwBM,IAAI,CAACC,KAAL,CAAW0C,GAAG,CAAG,MAAK9C,cAAtB,CAAzB,EACA,MAAKH,gBAFP,CAID,CAxHkB,OA0HnByB,QA1HmB,CA0HR,UAAM,CACf,GAAM2B,CAAAA,QAAQ,CAAG,MAAK3D,KAAL,CAAWG,OAAX,CAAmBwD,QAAnB,EAA+B,KAAhD,CAEA,MAAKrC,QAAL,CAAc,CACZE,OAAO,CAAE,IADG,CAAd,EAGA/B,QAAQ,CAACmE,MAAT,CAAgB,MAAK1C,MAArB,CAA6B,CAC3B2C,OAAO,CACL,IACA,MAAKjD,MAAL,EAAe,MAAKH,MAAL,CAAc,MAAKF,gBAAlC,CADA,CAEA,KAAOoD,QAAQ,CAAG,IAAlB,CAJyB,CAK3BA,QAAQ,CAAEA,QALiB,CAM3BG,eAAe,CAAE,IANU,CAA7B,EAOGC,KAPH,CAOS,UAAM,CACb,GAAMC,CAAAA,WAAW,CAAG,MAAKT,eAAL,EAApB,CACA,MAAKjC,QAAL,CAAc,CACZG,QAAQ,CAAE,IADE,CAEZb,MAAM,CAAE,MAAKI,WAAL,CAAiBgD,WAAjB,EAA8B3B,KAF1B,CAAd,EAIA,MAAKrC,KAAL,CAAWiE,SAAX,CAAqB,MAAKjD,WAAL,CAAiBgD,WAAjB,EAA8B3B,KAAnD,CAA0D2B,WAA1D,EACD,CAdD,EAeD,CA/IkB,OAiJnBE,WAjJmB,CAiJL,SAACC,CAAD,CAAIC,CAAJ,CAAOC,MAAP,CAAeC,CAAf,QACZ,qBAAC,IAAD,EACE,CAAC,CAAEH,CAAC,CAAGE,MAAM,CAAC/D,MAAP,CAAgB,CADzB,CAEE,CAAC,CAAE8D,CAAC,CAAG,EAFT,CAGE,IAAI,CACF,MAAKpE,KAAL,CAAWG,OAAX,CAAmBoE,SAAnB,CAA+B,MAAKvE,KAAL,CAAWG,OAAX,CAAmBoE,SAAlD,CAA8D,MAJlE,CAME,UAAU,CAAC,GANb,CAOE,QAAQ,CAAE,EAPZ,CAQE,UAAU,CAAC,MARb,EAUGhC,KAAK,CAACC,IAAN,CAAW,CAAClC,MAAM,CAAE+D,MAAM,CAAC/D,MAAhB,CAAX,EAAoCuC,GAApC,CAAwC,SAAC2B,CAAD,CAAIC,CAAJ,CAAU,CAEjD,GAAI,MAAKzE,KAAL,CAAWG,OAAX,CAAmBuE,SAAnB,GAAiC,UAArC,CAAiD,CAC/C,MACE,qBAAC,KAAD,EAAO,CAAC,CAAEP,CAAV,CAAa,EAAE,CAAE,MAAK3D,QAAtB,CAAgC,GAAG,QAAS8D,CAAT,WAAoBG,CAAvD,EACGJ,MAAM,CAACM,MAAP,CAAcF,CAAd,CADH,CADF,CAKD,CAND,IAQK,CACH,MAQE,qBAAC,GAAD,EAAK,MAAM,CAAC,KAAZ,CAAkB,KAAK,CAAC,KAAxB,EACV,oBAAC,CAAD,EAAG,QAAQ,CAAC,IAAZ,CAAiB,MAAM,CAAC,SAAxB,EACE,oBAAC,IAAD,EAAM,EAAE,CAAC,IAAT,CAAc,EAAE,CAAC,IAAjB,CAAsB,EAAE,CAAC,KAAzB,CAA+B,EAAE,CAAC,IAAlC,CAAuC,MAAM,CAAC,MAA9C,EADF,CAGE,oBAAC,IAAD,EAAM,CAAC,CAAC,IAAR,CAAa,CAAC,CAAC,IAAf,CAAoB,MAAM,CAAC,IAA3B,CAAgC,KAAK,CAAC,IAAtC,CAA2C,MAAM,CAAC,MAAlD,CAAyD,IAAI,CAAC,MAA9D,EAHF,CAKE,oBAAC,IAAD,EAAM,CAAC,CAAC,KAAR,CAAc,CAAC,CAAC,IAAhB,CAAqB,MAAM,CAAC,MAA5B,CAAmC,IAAI,CAAC,MAAxC,CAA+C,UAAU,CAAC,QAA1D,6BALF,CADU,CARF,CAoBD,CACF,CAhCA,CAVH,CADY,EAjJK,OAgMnBG,eAhMmB,CAgMD,UAAM,CACtB,MACE,qBAAC,IAAD,EAAM,KAAK,CAAEC,MAAM,CAACC,SAApB,EACG,MAAKC,WAAL,EADH,CAEE,oBAAC,QAAD,CAAU,IAAV,EACE,KAAK,CAAE,CACLC,UAAU,CAAE,QADP,CAELC,cAAc,CAAE,QAFX,CAGLC,SAAS,CAAE,CACT,CACEC,MAAM,CAAE,MAAKjE,MAAL,CAAYkE,WAAZ,CAAwB,CAC9BC,UAAU,CAAE,CAAC,CAAC,MAAK5E,MAAP,CAAe,CAAf,CAAkB,MAAKA,MAAvB,CADkB,CAE9B6E,WAAW,CAAE,KACP,MAAK7E,MADE,cAGR,MAAKA,MAHG,OAFiB,CAAxB,CADV,CADS,CAHN,CAeL8E,eAAe,CAAE,MAAKvF,KAAL,CAAWG,OAAX,CAAmBoF,eAAnB,CACb,MAAKvF,KAAL,CAAWG,OAAX,CAAmBoF,eADN,CAEb,MAjBC,CAkBL1F,KAAK,CAAEC,MAAM,CAAC,CAlBT,CAmBLA,MAAM,CAACA,MAAM,CAAC,CAnBT,CAoBL0F,YAAY,CAAE,CAAC3F,KAAK,CAAG,EAAT,EAAe,CApBxB,CAqBL4F,WAAW,CAAE,MAAKzF,KAAL,CAAWG,OAAX,CAAmBsF,WAAnB,CACT,MAAKzF,KAAL,CAAWG,OAAX,CAAmBsF,WADV,CAET,CAvBC,CAwBLC,WAAW,CAAE,MAAK1F,KAAL,CAAWG,OAAX,CAAmBuF,WAAnB,CACT,MAAK1F,KAAL,CAAWG,OAAX,CAAmBuF,WADV,CAET,MA1BC,CA2BLC,OAAO,CAAE,MAAKxD,KAAL,CAAWR,YA3Bf,CADT,EA8BE,oBAAC,WAAD,EACE,KAAK,CAAE,MAAKQ,KAAL,CAAWT,UADpB,CAEE,MAAM,CAAE,MAAKS,KAAL,CAAWT,UAFrB,CAGE,OAAO,QAAS7B,KAAT,KAAkBA,KAH3B,CAIE,KAAK,CAAE,CACLqF,SAAS,CAAE,CAAC,CAACC,MAAM,KAAM,MAAKxE,WAAX,MAAP,CAAD,CADN,CAELiF,MAAM,CAAE,EAFH,CAJT,EAQE,oBAAC,CAAD,EAAG,CAAC,CAAE/F,KAAK,CAAG,CAAd,CAAiB,CAAC,CAAEA,KAAK,CAAG,CAA5B,EACG,MAAKmB,WAAL,CAAiB6B,GAAjB,CAAqB,SAACC,GAAD,CAAMwB,CAAN,CAAY,CAChC,iCAAexB,GAAG,CAACQ,QAAnB,IAAOa,CAAP,kBAAUC,CAAV,kBACA,GAAMC,CAAAA,MAAM,CAAGvB,GAAG,CAACT,KAAJ,CAAUwD,QAAV,EAAf,CAEA,MACE,qBAAC,CAAD,EAAG,GAAG,QAASvB,CAAf,EACE,oBAAC,IAAD,EAAM,CAAC,CAAExB,GAAG,CAACM,IAAb,CAAmB,WAAW,CAAE,CAAhC,CAAmC,IAAI,CAAEN,GAAG,CAACO,KAA7C,EADF,CAEE,oBAAC,CAAD,EACE,QAAQ,CACLiB,CAAC,CAAG,MAAK7D,MAAV,CAAoB,MAAKF,gBAAzB,CACA,MAAKI,WAHT,CAKE,MAAM,CAAKwD,CAAL,MAAWC,CALnB,EAMG,MAAKF,WAAL,CAAiBC,CAAjB,CAAoBC,CAApB,CAAuBC,MAAvB,CAA+BC,CAA/B,CANH,CAFF,CADF,CAaD,CAjBA,CADH,CARF,CA9BF,CAFF,CADF,CAiED,CAlQkB,OAoQnBS,WApQmB,CAoQL,UAAM,CAClB,GAAMe,CAAAA,QAAQ,CAAG,MAAK9F,KAAL,CAAWG,OAAX,CAAmB2F,QAAnB,CACb,MAAK9F,KAAL,CAAWG,OAAX,CAAmB2F,QADN,CAEb,EAFJ,CAIA,GAAMC,CAAAA,IAAI,CAAGtG,QAAQ,CAACuG,MAAT,CACXvG,QAAQ,CAACwG,MAAT,CACExG,QAAQ,CAACuG,MAAT,CACEvG,QAAQ,CAACyG,QAAT,CAAkB,MAAKhF,MAAvB,CAA+B,MAAKP,WAApC,CADF,CAEE,MAAKF,MAFP,CADF,CAKE,GAAIhB,CAAAA,QAAQ,CAAC0B,KAAb,CAAmB,MAAKT,cAAxB,CALF,CADW,CAQX,CARW,CAAb,CAWA,MACE,qBAAC,QAAD,CAAU,IAAV,EACE,KAAK,CAAE,CACLb,KAAK,CAAEiG,QADF,CAELhG,MAAM,CAAEgG,QAAQ,CAAG,CAFd,CAGLb,cAAc,CAAE,UAHX,CAILkB,MAAM,CAAE,CAJH,CAKLR,OAAO,CAAE,MAAKxD,KAAL,CAAWR,YALf,CAMLuD,SAAS,CAAE,CACT,CACEC,MAAM,CAAEY,IAAI,CAACX,WAAL,CAAiB,CACvBC,UAAU,CAAE,CAAC,CAAC,CAAF,CAAK,CAAC,GAAN,CAAW,CAAC,MAAZ,CAAoB,MAApB,CAA4B,GAA5B,CAAiC,CAAjC,CADW,CAEvBC,WAAW,CAAE,CACX,MADW,CAEX,MAFW,CAGX,OAHW,CAIX,QAJW,CAKX,MALW,CAMX,MANW,CAFU,CAAjB,CADV,CADS,CANN,CADT,EAuBE,oBAAC,GAAD,EACE,KAAK,CAAEQ,QADT,CAEE,MAAM,CAAGA,QAAQ,CAAG,GAAZ,CAAmB,EAF7B,CAGE,OAAO,aAHT,CAIE,KAAK,CAAE,CACLZ,SAAS,CAAE,CAAC,CAACkB,UAAU,CAAE,CAAb,CAAD,CADN,CAJT,EAOE,oBAAC,KAAD,EACE,MAAM,CACJ,MAAKpG,KAAL,CAAWG,OAAX,CAAmBkG,UAAnB,CACI,MAAKrG,KAAL,CAAWG,OAAX,CAAmBkG,UADvB,CAEIC,OAAO,4BAJf,CAME,KAAK,CAAE,CAAEzG,KAAK,CAAEiG,QAAT,CAAmBhG,MAAM,CAAGgG,QAAQ,CAAG,GAAZ,CAAmB,EAA9C,CANT,EAPF,CAvBF,CADF,CA0CD,CA9TkB,CAEjB,MAAK3D,KAAL,CAAa,CACXZ,OAAO,CAAE,KADE,CAEXC,OAAO,CAAE,KAFE,CAGXC,QAAQ,CAAE,KAHC,CAIXb,MAAM,CAAE,IAJG,CAKXc,UAAU,CAAE,GAAIjC,CAAAA,QAAQ,CAAC0B,KAAb,CAAmBrB,MAAM,CAAG,CAA5B,CALD,CAMX6B,YAAY,CAAE,GAAIlC,CAAAA,QAAQ,CAAC0B,KAAb,CAAmB,CAAnB,CANH,CAOXS,SAAS,CAAE,GAAInC,CAAAA,QAAQ,CAAC0B,KAAb,CAAmBtB,KAAK,CAAG,CAAR,CAAY,EAA/B,CAPA,CAQXgC,QAAQ,CAAE,GAAIpC,CAAAA,QAAQ,CAAC0B,KAAb,CAAmBrB,MAAM,CAAG,CAAT,CAAa,EAAhC,CARC,CAAb,CAUA,MAAKsC,KAAL,CAAa,CAAb,CAEA,MAAKnC,YAAL,GAdiB,aAelB,C,+DAsDD,+BAAuB,CACrB,KAAKD,KAAL,CAAWG,OAAX,CAAmBiB,KAAnB,CAAyBmF,SAAzB,EACD,C,iCAED,4BAAoB,CAClB,KAAKxE,aAAL,GACD,C,gCAqPD,2BAAmB,iBACjB,GAAI,KAAKI,KAAL,CAAWX,OAAX,EAAsB,KAA1B,CAAiC,CAC/B,MACE,qBAAC,gBAAD,EAAkB,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACQ,QAAL,EAAN,EAA3B,EACG,KAAKhC,KAAL,CAAWG,OAAX,CAAmBqG,UAAnB,EADH,CADF,CAKD,CACF,C,sBAED,iBAAS,CACP,MACE,qBAAC,IAAD,EAAM,KAAK,CAAE3B,MAAM,CAACC,SAApB,EACE,oBAAC,gBAAD,EACE,KAAK,CAAE,CACL2B,QAAQ,CAAE,UADL,CAEL5G,KAAK,CAAEA,KAFF,CAGLC,MAAM,CAAEA,MAAM,CAAG,CAHZ,CAILmF,cAAc,CAAE,QAJX,CAKLD,UAAU,CAAE,QALP,CADT,EAQE,oBAAC,QAAD,CAAU,IAAV,EAAe,KAAK,CAAE,CAACH,MAAM,CAAC6B,OAAR,CAAiB,CAACC,OAAO,CAAE,EAAV,CAAjB,CAAtB,EACG,KAAK/B,eAAL,EADH,CARF,CADF,CAaG,KAAK5E,KAAL,CAAWG,OAAX,CAAmBqG,UAAnB,CAAgC,KAAKI,gBAAL,EAAhC,CAA0D,IAb7D,CADF,CAiBD,C,4BA7V0B9H,S,EAgW7B,cAAeiB,CAAAA,cAAf,CAEA,GAAM8E,CAAAA,MAAM,CAAGgC,UAAU,CAACC,MAAX,CAAkB,CAC/BhC,SAAS,CAAE,EADoB,CAQ/B4B,OAAO,CAAE,EARsB,CAS/BK,SAAS,CAAE,EAToB,CAAlB,CAAf","sourcesContent":["import React, {Component} from 'react';\r\nimport {\r\n  View,\r\n  StyleSheet,\r\n  Dimensions,\r\n  Animated,\r\n  TouchableOpacity,\r\n  Image,\r\n} from 'react-native';\r\nimport * as d3Shape from 'd3-shape';\r\n\r\nimport Svg, {G, Text, TSpan, Path, Pattern , Rect,Line\r\n} from 'react-native-svg';\r\n\r\nconst AnimatedSvg = Animated.createAnimatedComponent(Svg);\r\n\r\nconst {width, height} = Dimensions.get('screen');\r\n\r\nclass WheelOfFortune extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      enabled: false,\r\n      started: false,\r\n      finished: false,\r\n      winner: null,\r\n      gameScreen: new Animated.Value(height / 2),\r\n      wheelOpacity: new Animated.Value(1),\r\n      imageLeft: new Animated.Value(width / 2 - 30),\r\n      imageTop: new Animated.Value(height / 2 - 70),\r\n    };\r\n    this.angle = 0;\r\n\r\n    this.prepareWheel();\r\n  }\r\n\r\n  prepareWheel = () => {\r\n    this.Rewards = this.props.options.rewards;\r\n    this.RewardCount = this.Rewards.length;\r\n\r\n    this.numberOfSegments = this.RewardCount;\r\n    this.fontSize = 32;\r\n    this.onedeg = 360;\r\n    this.angleBySegment = this.onedeg / this.numberOfSegments;\r\n    this.angleOffset = this.angleBySegment / 2;\r\n    this.winner = this.props.options.winner\r\n      ? this.props.options.winner\r\n      : Math.floor(Math.random() * this.numberOfSegments);\r\n\r\n    this._wheelPaths = this.makeWheel();\r\n    this._angle = new Animated.Value(0);\r\n\r\n    this.props.options.onRef(this);\r\n  };\r\n\r\n  resetWheelState = () => {\r\n    this.setState({\r\n      enabled: false,\r\n      started: false,\r\n      finished: false,\r\n      winner: null,\r\n      gameScreen:new Animated.Value(height / 2),\r\n      wheelOpacity: new Animated.Value(1),\r\n      imageLeft: new Animated.Value(width / 2 - 30),\r\n      imageTop: new Animated.Value(height / 2 - 70),\r\n    });\r\n  };\r\n\r\n  _tryAgain = () => {\r\n    this.prepareWheel();\r\n    this.resetWheelState();\r\n    this.angleListener();\r\n    this._onPress();\r\n  };\r\n\r\n  angleListener = () => {\r\n    this._angle.addListener(event => {\r\n      if (this.state.enabled) {\r\n        this.setState({\r\n          enabled: false,\r\n          finished: false,\r\n        });\r\n      }\r\n\r\n      this.angle = event.value;\r\n    });\r\n  };\r\n\r\n  componentWillUnmount() {\r\n    this.props.options.onRef(undefined);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.angleListener();\r\n  }\r\n\r\n  makeWheel = () => {\r\n    const data = Array.from({length: this.numberOfSegments}).fill(1);\r\n    const arcs = d3Shape.pie()(data);\r\n    var colors = this.props.options.colors\r\n      ? this.props.options.colors\r\n      : [\r\n          '#E07026',\r\n          '#E8C22E',\r\n          '#ABC937',\r\n          '#4F991D',\r\n          '#22AFD3',\r\n          '#5858D0',\r\n          '#7B48C8',\r\n          '#D843B9',\r\n          '#E23B80',\r\n          '#D82B2B',\r\n        ];\r\n    return arcs.map((arc, index) => {\r\n      const instance = d3Shape\r\n        .arc()\r\n        .padAngle(0.001)\r\n        .outerRadius(width / 2)\r\n        .innerRadius(this.props.options.innerRadius || 100);\r\n      return {\r\n        path: instance(arc),\r\n        color: colors[index % colors.length],\r\n        value: this.Rewards[index],\r\n        centroid: instance.centroid(arc),\r\n      };\r\n    });\r\n  };\r\n\r\n  _getWinnerIndex = () => {\r\n    const deg = Math.abs(Math.round(this.angle % this.onedeg));\r\n    // wheel deging counterclockwise\r\n    if (this.angle < 0) {\r\n      return Math.floor(deg / this.angleBySegment);\r\n    }\r\n    // wheel deging clockwise\r\n    return (\r\n      (this.numberOfSegments - Math.floor(deg / this.angleBySegment)) %\r\n      this.numberOfSegments\r\n    );\r\n  };\r\n\r\n  _onPress = () => {\r\n    const duration = this.props.options.duration || 10000;\r\n\r\n    this.setState({\r\n      started: true,\r\n    });\r\n    Animated.timing(this._angle, {\r\n      toValue:\r\n        365 -\r\n        this.winner * (this.onedeg / this.numberOfSegments) +\r\n        360 * (duration / 1000),\r\n      duration: duration,\r\n      useNativeDriver: true,\r\n    }).start(() => {\r\n      const winnerIndex = this._getWinnerIndex();\r\n      this.setState({\r\n        finished: true,\r\n        winner: this._wheelPaths[winnerIndex].value,\r\n      });\r\n      this.props.getWinner(this._wheelPaths[winnerIndex].value, winnerIndex);\r\n    });\r\n  };\r\n\r\n  _textRender = (x, y, number, i) => (\r\n    <Text\r\n      x={x - number.length * 5}\r\n      y={y - 80}\r\n      fill={\r\n        this.props.options.textColor ? this.props.options.textColor : '#fff'\r\n      }\r\n      textAnchor=\"c\"\r\n      fontSize={42}\r\n      fontWeight=\"bold\"\r\n      >\r\n      {Array.from({length: number.length}).map((_, j) => {\r\n        // Render reward text vertically\r\n        if (this.props.options.textAngle === 'vertical') {\r\n          return (\r\n            <TSpan x={x} dy={this.fontSize} key={`arc-${i}-slice-${j}`}>\r\n              {number.charAt(j)}\r\n            </TSpan>\r\n          );\r\n        }\r\n        // Render reward text horizontally\r\n        else {\r\n          return (\r\n            // <TSpan\r\n            //   y={y - 40}\r\n            //   dx={this.fontSize * 0.07}\r\n            //   key={`arc-${i}-slice-${j}`}>\r\n            //   {number.charAt(j)}\r\n            // </TSpan>\r\n            \r\n            <Svg height=\"100\" width=\"200\">\r\n  <G rotation=\"50\" origin=\"100, 50\">\r\n    <Line x1=\"60\" y1=\"10\" x2=\"140\" y2=\"10\" stroke=\"#060\" />\r\n\r\n    <Rect x=\"60\" y=\"20\" height=\"50\" width=\"80\" stroke=\"#060\" fill=\"#060\" />\r\n\r\n    <Text x=\"100\" y=\"75\" stroke=\"#600\" fill=\"#600\" textAnchor=\"middle\">\r\n      Text grouped with shapes\r\n    </Text>\r\n  </G>\r\n</Svg>\r\n          );\r\n        }\r\n      })}\r\n    </Text>\r\n  );\r\n\r\n  _renderSvgWheel = () => {\r\n    return (\r\n      <View style={styles.container}>\r\n        {this._renderKnob()}\r\n        <Animated.View\r\n          style={{\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            transform: [\r\n              {\r\n                rotate: this._angle.interpolate({\r\n                  inputRange: [-this.onedeg, 0, this.onedeg],\r\n                  outputRange: [\r\n                    `-${this.onedeg}deg`,\r\n                    `0deg`,\r\n                    `${this.onedeg}deg`,\r\n                  ],\r\n                }),\r\n              },\r\n            ],\r\n            backgroundColor: this.props.options.backgroundColor\r\n              ? this.props.options.backgroundColor\r\n              : '#fff',\r\n            width: height/2,\r\n            height:height/2,\r\n            borderRadius: (width - 20) / 2,\r\n            borderWidth: this.props.options.borderWidth\r\n              ? this.props.options.borderWidth\r\n              : 2,\r\n            borderColor: this.props.options.borderColor\r\n              ? this.props.options.borderColor\r\n              : '#fff',\r\n            opacity: this.state.wheelOpacity,\r\n          }}>\r\n          <AnimatedSvg\r\n            width={this.state.gameScreen}\r\n            height={this.state.gameScreen}\r\n            viewBox={`0 0 ${width} ${width}`}\r\n            style={{\r\n              transform: [{rotate: `-${this.angleOffset}deg`}],\r\n              margin: 10,\r\n            }}>\r\n            <G y={width / 2} x={width / 2}>\r\n              {this._wheelPaths.map((arc, i) => {\r\n                const [x, y] = arc.centroid;\r\n                const number = arc.value.toString();\r\n\r\n                return (\r\n                  <G key={`arc-${i}`}>\r\n                    <Path d={arc.path} strokeWidth={2} fill={arc.color} />\r\n                    <G\r\n                      rotation={\r\n                        (i * this.onedeg) / this.numberOfSegments +\r\n                        this.angleOffset\r\n                      }\r\n                      origin={`${x}, ${y}`}>\r\n                      {this._textRender(x, y, number, i)}\r\n                    </G>\r\n                  </G>\r\n                );\r\n              })}\r\n            </G>\r\n          </AnimatedSvg>\r\n        </Animated.View>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  _renderKnob = () => {\r\n    const knobSize = this.props.options.knobSize\r\n      ? this.props.options.knobSize\r\n      : 20;\r\n    // [0, this.numberOfSegments]\r\n    const YOLO = Animated.modulo(\r\n      Animated.divide(\r\n        Animated.modulo(\r\n          Animated.subtract(this._angle, this.angleOffset),\r\n          this.onedeg,\r\n        ),\r\n        new Animated.Value(this.angleBySegment),\r\n      ),\r\n      1,\r\n    );\r\n\r\n    return (\r\n      <Animated.View\r\n        style={{\r\n          width: knobSize,\r\n          height: knobSize * 2,\r\n          justifyContent: 'flex-end',\r\n          zIndex: 1,\r\n          opacity: this.state.wheelOpacity,\r\n          transform: [\r\n            {\r\n              rotate: YOLO.interpolate({\r\n                inputRange: [-1, -0.5, -0.0001, 0.0001, 0.5, 1],\r\n                outputRange: [\r\n                  '0deg',\r\n                  '0deg',\r\n                  '35deg',\r\n                  '-35deg',\r\n                  '0deg',\r\n                  '0deg',\r\n                ],\r\n              }),\r\n            },\r\n          ],\r\n        }}>\r\n        <Svg\r\n          width={knobSize}\r\n          height={(knobSize * 100) / 57}\r\n          viewBox={`0 0 57 100`}\r\n          style={{\r\n            transform: [{translateY: 8}],\r\n          }}>\r\n          <Image\r\n            source={\r\n              this.props.options.knobSource\r\n                ? this.props.options.knobSource\r\n                : require('./assets/images/knob.png')\r\n            }\r\n            style={{ width: knobSize, height: (knobSize * 100) / 57 }}\r\n          />\r\n        </Svg>\r\n      </Animated.View>\r\n    );\r\n  };\r\n\r\n  _renderTopToPlay() {\r\n    if (this.state.started == false) {\r\n      return (\r\n        <TouchableOpacity onPress={() => this._onPress()}>\r\n          {this.props.options.playButton()}\r\n        </TouchableOpacity>\r\n      );\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <View style={styles.container}>\r\n        <TouchableOpacity\r\n          style={{\r\n            position: 'absolute',\r\n            width: width,\r\n            height: height / 2,\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n          }}>\r\n          <Animated.View style={[styles.content, {padding: 10}]}>\r\n            {this._renderSvgWheel()}\r\n          </Animated.View>\r\n        </TouchableOpacity>\r\n        {this.props.options.playButton ? this._renderTopToPlay() : null}\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nexport default WheelOfFortune;\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    // flex: 1,\r\n    // justifyContent: 'center',\r\n    // alignItems: 'center',\r\n    // marginTop:250\r\n   \r\n  },\r\n  content: {},\r\n  startText: {\r\n    // fontSize: 50,\r\n    // color: '#fff',\r\n    // fontWeight: 'bold',\r\n    // textShadowColor: 'rgba(0, 0, 0, 0.4)',\r\n    // textShadowOffset: {width: -1, height: 1},\r\n    // textShadowRadius: 10,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}